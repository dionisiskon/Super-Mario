<!DOCTYPE HTML>
<html>
<head>
<title>Super-Mario</title>	
	<link href="https://fonts.googleapis.com/css?family=Press+Start+2P" rel="stylesheet" type='text/css'>
<meta charset="utf-8">
<style>
body {
	font-family: 'Press Start 2P', cursive;
	font-weight: normal;
   	font-style: normal;
	margin: 0;
	padding: 0;
	background-color: #000;
}
</style>
<script src="splash.js"></script>
<script src="state1.js"></script>
<script src="preloader1.js"></script>
<script src="options.js"></script>
<script src="//cdn.jsdelivr.net/phaser/2.6.2/phaser.min.js"></script>
</head>
<body>
	<script type="text/javascript">
		var game = new Phaser.Game(256, 240, Phaser.AUTO, '',this, false, false);
		function preload(){
			//this.load.baseURL = 'https://dionisiskon.github.io/Super-Mario/';
			//this.load.crossOrigin = 'anonymous';
		}
		var music;
		var scoreText;
		var ccounter;
		var cvalue=0;
		var cimage;
		var limage;
		var lives=3;     //variables for music,text and
		var lcounter;     
		var gkill;
		var gokill=0;
		var ckill=0;
		var gimage;
		var jumps;
		var stomps;
		var csound;
		var deaths;
		var score=0; 
		var cclear;

		game.state.add('state1', state1);
		game.state.add('splash',splash);
		game.state.start('splash');

		function pipesOverlap(player,pipes){
 		if (cursors.down.isDown && (player.body.onFloor())) {
 			player.body.enable=false;
 			player.animations.play('tp');
 			game.time.events.add(Phaser.Timer.SECOND*1.3 , function() {
 				player.body.enable=true;
 				player.reset(1720,170);
 		});
 	}
 }
		function coinOverlap(player, coin) {
			cvalue += 1;
    		ccounter.text = 'X' + cvalue;
			csound = game.add.audio('coinsc');
			score +=100;
			scoreText.text='WARIO\n'+score;
			csound.play();
			ckill=ckill+1;
			if (gokill==16 && ckill==50 ){
						music.stop();
    					cclear=game.add.audio('clearc');
    					cclear.play();
    					setTimeout(function(){
						game.state.start('splash');
						 }, 4000);
    				}
			coin.kill();
		}
		function pyroguyOverlap(player, pyroguy) {		
			if (player.body.touching.down) {
				pyroguy.animations.stop();
				pyroguy.frame = 2;
				pyroguy.body.enable = false;
				player.body.velocity.y = -80;
				stomps = game.add.audio('stomp');
		        stomps.play();
				game.time.events.add(Phaser.Timer.SECOND, function() {
					pyroguy.kill();
				});
									}
			 else {
				player.frame = 14;
				player.body.enable = false;
				player.animations.stop();
				music.stop();
				deaths=game.add.audio('death');
				deaths.play();
				if(lives>1){
					setTimeout(function(){
				score=0;
				cvalue=0;
				lives-=1;
				gokill=0;
				ckill=0;
    		    		game.state.start('splash');
    		   		 }, 4000);
    					} else {
				setTimeout(function(){
				location.reload();
				}, 4000);}
			}
		}
		function pyroguysDirection(pyroguys,layer){
		if (pyroguys.body.position.x - pyroguys.body.prev.x <= 0){					
			pyroguys.animations.play('walkRight');
			}
			else{
			pyroguys.animations.play('walkLeft');
			}
		}
	
 

		function goombaOverlap(player, goomba) {		
			if (player.body.touching.down) {
				goomba.animations.stop();
				goomba.frame = 2;
				goomba.body.enable = false;
				player.body.velocity.y = -80;
				stomps = game.add.audio('stomp');
		        	stomps.play();
		        	score += 100;
    				scoreText.text = 'WARIO\n' + score;
    				gokill=gokill+1;
    				gkill.text='X' + gokill; 
				game.time.events.add(Phaser.Timer.SECOND, function() {
					goomba.kill();
				});
									}
			 else {
				player.frame = 14;
				player.body.enable = false;
				player.animations.stop();
				music.stop();
				deaths=game.add.audio('death');
				deaths.play();
				if(lives>1){
					setTimeout(function(){
					score=0;
					cvalue=0;
					lives-=1;
					gokill=0;
					ckill=0;
    		    		game.state.start('game.state.current');
    		   		 }, 4000);
    					} else {
				setTimeout(function(){
				game.state.start('splash');
				}, 4000);}
			}
		}
	</script>
</body>
</html>
